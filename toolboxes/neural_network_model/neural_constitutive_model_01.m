function [Y,Xf,Af] = neural_constitutive_model_01(X,~,~)
%NEURAL_CONSTITUTIVE_MODEL_01 neural network simulation function.
%
% Auto-generated by MATLAB, 13-Aug-2019 12:15:23.
% 
% [Y] = neural_constitutive_model_01(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 14xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 14xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-9.19072150828133;-7.31642520184961;-117.581837743857;-0.0567051168467296;-2.49804721473964;-0.332371268844762;-0.0695646185869343;-0.0728245303746552;-0.0955345201304235;-4.76656043189404e-05;-0.0050793874728759;-0.000651298278452835;0;0];
x1_step1.gain = [0.107160151324934;0.132059910400565;0.00855368334167594;16.8526753118065;0.401500284130658;2.94276566167905;17.3663861737294;16.2921294493012;8.40605731927635;11745.4729614372;249.816215847772;1784.58901600639;137.013854935633;1578662.04945602];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.8642222325848789577;-0.34487208164701393942;-1.1036322129598650221;-0.73568817145566489657;-0.25939399516254013633;-2.440344372118044447;0.72734490149609620779;-0.082422942707434193599;-0.96235289667849865936;1.0872367258163393444;-0.28425829042148931247;-3.2558983087872102047;-0.045435332282706339391;-0.17312756189286651609];
IW1_1 = [0.13652899761530618017 0.16304223478106583123 0.12058320859432521133 -0.18878667083079542222 -0.21840063030809250821 -0.23233908331350056065 0.15553322797781191089 0.23817363666407045941 -0.19903658706979804327 1.2059274417011549563 -0.098682163818904086727 0.50642306360847788582 0.32021637069255548536 0.74089992062842469078;-0.05663046486865807444 -0.1131263123639008189 0.079250493084348935802 0.13972106818189639066 -0.064663339107615042112 -0.080170537627329785391 0.23301206564217574746 0.18940084851019073353 -0.21258464884983707677 -0.72431923788750118831 0.35641806306394024917 0.12857495242433361615 0.51427802077612971843 -0.14367146723434431888;-0.44084027492210137167 -0.34227817202368532312 -0.60656340191608459911 -0.51372640550974135731 0.63446716013869930428 0.64380037115319721508 -0.031521878912287235042 -0.10732485557505057339 0.074735907575924645507 -1.2427367947756875477 0.19005662600559497522 -0.33199389980304799819 1.1337517108635584151 0.18396798493901483917;0.0055439630381574076315 0.21088046301164337093 -0.28827095047751732926 0.87800785477145404379 0.21622324152102456729 0.69476018961350871628 -0.02184940625058241076 0.048277760762159650787 -0.013289793148760558825 1.1805275792087190911 -0.24178414190951708074 0.2736099119627430909 -1.2560407680057328328 -0.23465221493921795126;0.21806636505408366622 0.1871934931171619354 0.18513102376066770116 -0.11636071091788752208 -0.16915306504638197294 -0.27655324127204283791 0.09947741412995975141 0.14243438555443255211 -0.12062572131939555686 0.46410716456999290269 -0.017136688585430152887 0.22223406663791608895 0.86303251181251927626 1.1825627130238918205;-0.12559708595095822603 0.42142709539766604054 -1.1194779876765981186 -0.16941400694093478041 1.1056343363209033548 1.5375949912891406779 0.1341639871439871956 0.21674035819047088314 -0.17539025113093587027 0.87614377854144587232 -0.15513686738277565613 0.36998745857718301489 -0.083080303000018521087 0.32093907675965704929;-0.13632515621565305386 -0.012908344696861924483 -0.24457656522643511643 -0.54666985056547834354 0.17410441641579887939 0.13587735209271575854 0.029120320875092562535 0.032269723955672548199 -0.028579099528827034415 -0.27235865729460362328 0.012992768435578672115 -0.022145284871611679856 0.54003389811136148779 0.21570749877332809352;-0.38302056601957068516 -0.31711849506466560644 -0.3154933523051732247 -0.17515883093121262237 0.26071439123656414694 0.30962037661179864223 0.4149754306728757336 0.60168228519681266064 -0.50727171611732624346 1.5204427064607912712 -0.20252201425243157584 0.91049047438019614642 0.32381962460806656967 0.65868678622384413401;0.31861751831769485888 0.39956144164499174387 0.08066181089231243273 0.55258691662967096558 -0.11309904161593226091 0.13026757379837253237 -0.29012491169120085965 -0.23555947581350766828 0.2602900058339270295 1.1770268212303027777 -0.41405770508424472043 -0.10088407412625988169 -0.11881858501180878052 -0.17881738258567375643;0.41889085342521575894 0.87946058235214341625 -0.24764202795330450546 0.61702415243033381653 0.082405081161491006148 0.60059118681428613762 -0.35815363429452939936 -0.33418426578174909025 0.34866263139649256164 0.79663366792884426903 -0.4145652126229721901 -0.2716361320524917633 -0.41219736886012103838 -0.084647333107161368271;-0.25250364938881514343 -0.56268328899266395471 0.1083482012167372166 -0.10602843162794152454 0.023490476362066591703 -0.19446858019587368038 0.28983955408464695536 0.35218239679060564518 -0.32247964174069621013 0.28706884369312235528 0.099475120620224330437 0.43251862008290647976 -0.090563855812582333416 0.11885152407850918532;0.48361702208512247214 -0.093756414131292611924 1.411047683175263634 0.1120255671010149251 -1.2441154231065290059 -1.92287442511964346 -0.23308014444770150386 -0.18377923549029415162 0.21013860007302728738 0.052709615322459310582 -0.37910614277018134244 -0.33078478155011731277 -0.3079721641023089318 0.78275993732589532748;0.20828010378918457302 -0.094156555635555652661 0.65947214121143304943 0.23169582836857538499 -0.57165339512637292074 -0.83667584882703682769 0.28929093303779535029 0.27596660641209946885 -0.2827069342816174724 -0.22644065690673031988 0.34142077060476527794 0.29562522042652550347 -0.18657381798485997426 0.32003770790920466061;-0.14920624591671824422 -0.50429650455202046366 0.13842114004264721716 -0.21639598392037917574 0.048225306390889524644 -0.23222222041793380565 -0.043725002319072885093 -0.19812257598265792247 0.11931226836009088677 -1.1731086009646345403 0.50774757381746571383 -0.39103036969866267203 0.29430782042580494462 0.46030085792911340503];

% Layer 2
b2 = [-1.586690407451873952;-0.3934711048009909562;0.5144985517682997278;-1.4718962314184360629;0.27124769505537799086;0.79041187430051329521;1.694846038940946098;-0.7134660370607679436;-0.83402223381449480666;1.0600701391695579456;-0.67239575466383660896;-1.795243768388380623;1.3712433444541884953;-0.67105814962396459489];
LW2_1 = [-0.56476912264680323439 -0.12314768045660968998 0.48356128728700781272 -0.39228259721791203241 0.52751638946898304905 -0.22710843695226634598 0.47714438159866451317 0.48716230037891672389 -0.051389364261289607883 -0.33970951954663614059 -0.098494181796595428602 0.72646663866196148351 0.52892164299824984131 -0.41312927858097331368;-0.64662465854750994509 0.73117866039957468693 0.93484442529202971262 0.64895199677389303616 -0.095169940935438179785 0.57032502470120516325 0.092689337818179493023 0.049600545065554807467 -0.022667317017330625845 -0.39947061248541942957 -0.35862866138419347006 0.6344792092284753382 0.31223809595270235473 0.478541524820780384;-0.11759550650581103437 0.11753134335340542638 0.16023955372749662529 0.76372628086806038095 0.73645922499903104796 -0.50733654283669249452 -0.22943105677599315295 -0.16198606620459257699 0.81791425989503230287 0.89536311403225699035 -0.30794985675192720898 -2.1103077994488659286 -0.19531203169750399606 -0.67399161934102169713;-1.4019050928555381041 0.014755095356638376139 0.64077167808377422098 -0.43938625450046092658 1.1826764649938548146 0.011395226466835802273 0.38553522780132948311 -0.43289716517737381052 0.56225029681822047412 -0.040248754557273412613 -0.39796972790651585772 0.53420835168342917232 0.58686920530138031449 0.9432744737242459987;0.19114269146929310783 0.061825224646182938559 -0.97553222247604709505 -1.4111056253908829117 -0.14871251654186459779 -1.4944069312016992068 0.060106612280209095744 -0.53780899359610878641 -0.056336299978347326167 0.67248235420132929097 -0.39547633499584744499 -0.76296648469608174814 -0.28823724857138743882 -0.66842248821118799285;0.18520099079190655011 -0.72808539063850730155 -0.1711537450407032146 1.0300635573785370536 0.4861369409357669813 -0.3674948601544106852 -0.087438194148145714779 -0.56924606377692110737 -1.1555416188389018295 0.95460210695736646969 -0.14902436642856906057 -1.2471316543365495999 0.16371682272096504951 -0.19273211428991660066;0.72129502516906840448 0.035364068855100641575 0.53987140777747322229 -0.014291723848277071082 -0.66556691300721626536 0.4991595116970341528 0.33366788244780515305 0.45113865110306505812 -0.039213928912123011128 0.13674156662386643957 0.45794391226350861235 -1.5177468964065896628 -0.38996626180512050652 0.10604307638736333586;-0.16078607866824348727 -0.46433835741735518532 -0.60806287419546634077 -0.18171789470261462407 -0.14359524008013818674 0.054984327682922537472 0.16246621309787512288 0.038909170020286570901 -0.14489296383797570233 -0.59832600124421919663 0.069412182479835965454 1.796304983525235377 0.45579732514170340218 0.47853253915992272072;-0.072335777688585012335 0.47049479101745916854 0.75507499031313340954 0.24090516062644806716 -0.4088499559315696974 1.1307304563837508038 0.31685133222726497015 0.098831055063460973575 -1.0149974491151363409 -0.47941984623530642384 -0.15676809894454413197 0.065776729963712254889 0.22394106530279642153 -0.54258515095385972948;0.63679485901359866862 -0.066369954039824347047 -0.25089453060943162077 0.21550353424514179235 -0.22680220079812776768 0.091475203950080644089 -0.35262148751793581658 -0.66895058587120925786 -0.18129716056690078907 0.27821459297201145411 0.28998480072052212897 -0.88869441162438722603 -0.48329536025291847112 0.069484782152587576398;-0.0056730329583071885391 0.19539409975470978242 0.88104055870368214176 -0.94164532956110869044 -0.24161867307593370979 0.62913600416644432922 0.35136182385285869012 -0.067667362328562949414 -0.53030967386430438726 -0.5369128829586971019 0.74774815762674817776 -0.1999265193994226586 0.17072798814054276906 0.57554043220557138394;-0.92896586989859553096 0.20228279494698700458 0.51304212089104861416 -0.17787889878908280661 0.10151634609780299523 2.8000971295803598338 0.011345443459809364389 -0.56218884083704179222 0.084747108997048126167 0.081700495951526549976 0.019637449498158366518 0.65552986276556279854 0.11270337820220417691 0.0017819751703460643896;1.1075327679317068519 -0.043262255947341309026 0.55342873436753725613 -0.022039500393284474494 -0.1222888327306643208 0.66603587777141481929 -0.037536300021707588725 -1.481800748373220955 -0.055441973664834859337 0.44303972867074442599 0.098984021852185855028 -1.9907567209328940194 -0.81201790074657609342 0.16513020603767539218;-0.6785244317794162372 0.66605382579968763768 0.50149864261696486256 -0.40021001627630398145 -0.026639846432073299026 0.015588239509015458517 0.36766374897125680965 0.12623083834338608145 0.13353865045493662489 -0.21774466327056421489 -0.38026156251838511002 0.6430444890690577564 0.3557950927429450183 0.11828707293695105152];

% Layer 3
b3 = [-0.12949661064431239321;-0.14140859131612812383;0.1357157552052601357;-0.044246339112498839219;-0.0996586980998636629;-0.16892109420640444295;-0.13657880836445848716;-0.14813105397060863377;0.14253020634707738723;-0.03534804335158228672;-0.10740234751980663741;-0.17548738635635496852;0.29601570383915987161;-0.30608723052586273017];
LW3_2 = [0.11727182660185492269 0.24046863518031988405 0.18292007334031251675 -0.2913473384088746676 0.12119045472805617392 -0.13558473730592199291 0.27200427149881500899 0.24132475611475578958 -0.058811348835417595615 -0.29433813608957976049 0.096494726277393388925 0.49613458089576478738 0.4012905719550825534 -0.32042725452315246049;0.098519733579868429274 0.24356578148779706172 0.18352166928895680131 -0.29240265888997418742 0.12204883940268651532 -0.13585514159953698821 0.27411868597169103401 0.24035452755757405474 -0.053344038599085777386 -0.32469346001485299702 0.10001035674109133577 0.49224968714004796455 0.40159431109216892075 -0.34238674682562120211;-0.10761935703669499309 -0.24208175989726735122 -0.18324331593027448628 0.29191222334206862188 -0.12164150446694106666 0.13573390889154141048 -0.27311339040498328057 -0.24084244893070330673 0.055998891026791688952 0.30999847511795824984 -0.098312981690946599223 -0.49416918178272961626 -0.40147624103463397383 0.33176399434372921826;-0.34914932185513353202 -0.20040910095993738627 -0.18213938308284430279 0.26310272775925724886 -0.11270875026944716935 0.13393492749973243128 -0.24795502410568021068 -0.2544458848573596943 0.11760968648254012392 -0.107554106754629758 -0.052610869230333041913 -0.54222302964262336644 -0.38153458451513333483 0.036434225592056682097;0.16673633098284584841 0.23185371545681415784 0.18054332539779940903 -0.28980019203715917664 0.11860482493747666333 -0.13486469638342729604 0.26633868981935376885 0.24358478446425146924 -0.073624468081129032515 -0.21585063466966528112 0.087013843367640994475 0.50535596367468837986 0.40089457358695579359 -0.2629933234846854595;0.059654324171604905525 0.2498816275880938742 0.18280879397512350693 -0.2953305489485154034 0.12331294498601848286 -0.13514574564165229842 0.27662810632185186321 0.23740217061271359777 -0.043584486654922198479 -0.38989352688565198646 0.10694610835622979372 0.48392910492872887041 0.40548186136397890156 -0.38796706368569439105;0.10631764660602625872 0.24237763164793835191 0.18312257324860856111 -0.29194243195283392511 0.12175590980185863055 -0.1355830148607422847 0.27310108586230441574 0.2406749271063525486 -0.055741460480684699996 -0.31214751350976460698 0.098533732149273661749 0.49397411920655515116 0.40168513453776244493 -0.33318555227044333034;0.087621443261580361783 0.24543450291196633462 0.18372806068728195217 -0.29285233647626401909 0.12261568338538031409 -0.13583713851319861865 0.27519286762045952477 0.23969875522876329943 -0.050240708402454557768 -0.34220735676052699281 0.10202164144449665795 0.49000756478909474056 0.40191218020411950684 -0.35496080640745897306;-0.096685878838983066452 -0.24395244732396276222 -0.1834345036597080647 0.29241118964114704015 -0.12219884141402642674 0.13571393235022022328 -0.27417871407070670831 -0.24017203030680761566 0.052907624883934689652 0.32763351481019775679 -0.10033060671814814091 -0.49193065988595113813 -0.40180210219642314984 0.34440356199424904116;-0.33745795274791134943 -0.20251765434746032968 -0.18221915497346133361 0.26481442750256523055 -0.11315257531232593424 0.13404908620298480737 -0.24922367523913357967 -0.25377180280060018802 0.11493313470299741652 -0.086928862159258560305 -0.054857908316786871405 -0.54043840995270875371 -0.38241306296401678111 0.050768952207210137073;0.15560976888455024802 0.23380189007866067352 0.18067720621150079596 -0.29071882520594044541 0.1191323723086210179 -0.13486598207124339543 0.26740835009913088705 0.24287469083420384908 -0.070625880020256617819 -0.23436333110709231531 0.089097689029475513056 0.50328427310794454641 0.40137874191791506062 -0.27615088891613154276;0.04885116601678553272 0.25173269356476396519 0.18302473353075282558 -0.29566775959896635095 0.12389466888498047725 -0.13510645709442045681 0.2776636932755313647 0.23674017550945636312 -0.040425928276497491431 -0.40708587190771289288 0.10893619647347861645 0.48166616921885824221 0.40575928181157416841 -0.40037300074934178973;-0.050041622881839588344 0.37342467886198288385 -0.28916901898085273226 -0.58059122556429265671 0.20596181560615389738 0.24779638653427471517 -0.45060957523685524206 -0.42370269569369817253 -0.043640249608932327186 -0.70697191608330800516 0.099912010487053906638 0.87542896716449769556 -0.57747211752372729077 -0.52837017189340573786;-0.32734741157800806288 0.42980511204225524402 -0.31462532617693866888 -0.85576688879747486727 0.20495982198038567579 0.35145109409735553196 -0.57016815157665734493 -0.51433556531974022885 -0.12824263657423076723 -1.4204477750190311891 0.18555530058106958768 0.63432805228714417289 -0.24980347456551857399 -0.7298264477961701191];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [37888.6091985624;35658.903926407;18371.3150132989;24147407.8262589;540092.344965341;3935616.0924073;37916.0834012815;35682.7431527534;18382.7640835146;24154341.4693035;540415.967348709;3938714.53016745;33205.6456701611;5213247.0361114];
y1_step1.xoffset = [-2.36572728176841e-05;-2.5018805546671e-05;-6.01972085626364e-05;-4.3041999313511e-08;-1.68036631275772e-06;-2.24274591628601e-07;-2.3572157027362e-05;-2.4938633107299e-05;-6.02867764833872e-05;-4.31885917500349e-08;-1.67356467715901e-06;-2.23543268156052e-07;0;0];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = poslin_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Linear Positive Transfer Function
function a = poslin_apply(n,~)
  a = max(0,n);
  a(isnan(n)) = nan;
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
